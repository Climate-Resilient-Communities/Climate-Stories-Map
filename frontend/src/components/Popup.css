/* Base popup styles */
.leaflet-popup,
.leaflet-popup-content-wrapper,
.leaflet-popup-content,
.custom-popup {
  background-color: var(--surface-color) !important;
  color: var(--text-primary) !important;
  border-radius: var(--border-radius-md) !important;
  box-shadow: var(--shadow-md) !important;
}

.leaflet-popup-tip {
  background-color: var(--surface-color) !important;
}

/* Content wrapper styles */
.leaflet-popup-content {
  margin: var(--spacing-md) !important;
}

/* Specific popup styles */
.popup-title {
  color: var(--text-primary) !important;
  font-weight: bold !important;
  margin-bottom: var(--spacing-sm) !important;
}

.popup-description {
  color: var(--text-primary) !important;
  margin-bottom: var(--spacing-sm) !important;
}

.popup-date {
  color: var(--text-secondary) !important;
  display: block !important;
  margin-bottom: var(--spacing-sm) !important;
  font-size: 0.9em !important;
}

.popup-tags,
.popup-opt-tags {
  display: flex !important;
  flex-wrap: wrap !important;
  gap: var(--spacing-xs) !important;
  margin-top: var(--spacing-xs) !important;
}

.popup-tag {
  color: var(--text-secondary) !important;
  background-color: var(--background-color) !important;
  padding: 2px 6px !important;
  border-radius: var(--border-radius-sm) !important;
  font-size: 0.9em !important;
  border: 1px solid var(--border-color) !important;
}

/* Close button */
.leaflet-popup-close-button {
  color: var(--text-secondary) !important;
  opacity: 0.7 !important;
  transition: opacity var(--transition-fast) !important;
}

.leaflet-popup-close-button:hover {
  color: var(--text-primary) !important;
  opacity: 1 !important;
  background: none !important;
}

/* Ensure good contrast in all themes */
:root[data-theme='high-contrast'] {
  & .leaflet-popup,
  & .leaflet-popup-content-wrapper,
  & .leaflet-popup-content,
  & .custom-popup {
    border: 1px solid var(--primary-color) !important;
  }
  
  & .popup-tag {
    border-color: var(--primary-color) !important;
  }
}

/* Sepia theme adjustments */
:root[data-theme='sepia'] {
  & .popup-tag {
    background-color: var(--surface-color) !important;
  }
}